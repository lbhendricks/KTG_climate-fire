---
title: "R Notebook"
---

```{r}
library(sp)
library(GISTools)
library(rgdal)
```

Read in a very rough shapefile with the boundaries of the countries, and then extract the three countries that make up Borneo. (We don't need a detailed shapefile here, because it is just to give us a very general idea of where we are and to make sure that things are scaling correctly etc.)
```{r}
# read in the shapefile
countries<-readOGR(dsn="/Users/laurenhendricks/Documents/GIS_Data/ne_110m_admin_0_countries/",layer="ne_110m_admin_0_countries")

# subset out Indonesia, Malaysia, and Brunei
SEAsia<-countries[countries$SOVEREIGNT=="Indonesia"|countries$SOVEREIGNT=="Malaysia"|countries$SOVEREIGNT=="Brunei",]

# plot it
plot(SEAsia)

# reproject it UTM 49 S (CRS from http://spatialreference.org/ref/epsg/23889/)
SEAsia_proj<-spTransform(SEAsia,"+proj=utm +zone=49 +south +a=6378160 +b=6356774.50408554 +units=m +no_defs")
plot(SEAsia_proj)
```
Then make a shapefile with the Ketapang airport (KTG)
```{r}
# create a shapefile with the coordinates of KTG
KTG<-cbind(109.9619,-1.8166)
KTG.sp<-SpatialPoints(KTG,proj4string = CRS("+proj=longlat +ellps=WGS84"),bbox=NULL)
KTG.sp_proj<-spTransform(KTG.sp,"+proj=utm +zone=49 +south +a=6378160 +b=6356774.50408554 +units=m +no_defs")

# plot the airport on top of SE Asia
plot(SEAsia_proj)
plot(KTG.sp_proj,add=T,pch=17)
```

Now, make some buffers. Remember that gBuffer needs projected data!
```{r}
# buffers of varying distances. projection units are in meters! 
KTG_buffer5km<-gBuffer(KTG.sp_proj,width=5000,byid=FALSE)
KTG_buffer50km<-gBuffer(KTG.sp_proj,width=50000,byid=FALSE)
KTG_buffer250km<-gBuffer(KTG.sp_proj,width=250000,byid=FALSE)
KTG_buffer500km<-gBuffer(KTG.sp_proj,width=500000,byid=FALSE)

# then plot it to make sure that it works
plot(SEAsia_proj)
plot(KTG.sp_proj,add=T,pch=17)
plot(KTG_buffer500km,add=T,col="red")
plot(KTG_buffer250km,add=T,col="blue")
plot(KTG_buffer50km,add=T,col="green")
plot(KTG_buffer5km,add=T,col="yellow")
```

Transform all of the buffers back to lat/lon coordinates (unproject) so we can get the min and max coordinates of each, as a starting point for winnowing out the fire detections we want (basically, treat it as a square to start). 
```{r}
# transform (take away projection)
KTG_buffer5km_latlon<-spTransform(KTG_buffer5km,"+proj=longlat +ellps=WGS84")
KTG_buffer50km_latlon<-spTransform(KTG_buffer50km,"+proj=longlat +ellps=WGS84")
KTG_buffer250km_latlon<-spTransform(KTG_buffer250km,"+proj=longlat +ellps=WGS84")
KTG_buffer500km_latlon<-spTransform(KTG_buffer500km,"+proj=longlat +ellps=WGS84")

# then use bbox (in sp) to get teh coordinates of the bounding box
#[1] is the min x coordinate; [2] is the min y coordinate; [3] is the max x coordinate; [4] is the max y coordinate
KTG_buffer5km_bbox<-bbox(KTG_buffer5km_latlon)
KTG_buffer50km_bbox<-bbox(KTG_buffer50km_latlon)
KTG_buffer250km_bbox<-bbox(KTG_buffer250km_latlon)
KTG_buffer500km_bbox<-bbox(KTG_buffer500km_latlon)
```

